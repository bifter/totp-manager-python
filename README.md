# A Python console app - TOTP (2FA) Token Manager with encrypted file storage

This app outputs time-based 2FA tokens including the number of remaining seconds.

## Example output

    ID     TITLE       TOKEN
    1:     Google      437285    Remaining Secs: 25
    2:     Hotmail     783345    Remaining Secs: 25
    3:     Github      637234    Remaining Secs: 25

This app requires the 2FA Base32 secret text which is available (along with a QR code) when you setup 2FA with an application.

Encryption: AES (MODE_CBC) with HMAC authentication based on https://gist.github.com/jbtule/4336842

The encrypted data file is compatible with a .NET core cross-platform console app at: https://github.com/bifter/totp-manager-dotnetcore

The data file is an encrypted json file containing the totp data.

## Setup
1. Update the PATH_TO_SHARED_DATAFILE variable to the path you want the data file to be stored in.
2. Add an initial totp item using: {password to encrypt/decrypt the data file } -a {name of app i.e. 'Google'} {2FA Base32 secret} [Optional {Number of totp digits (defaults to 6)}]

## Basic usage
* To view totp tokens: {password}
* Add an item: {password to encrypt/decrypt the data file } -a {name of app i.e. 'Google'} {Base32 secret text} [Number of totp digits (defaults to 6)]
* Edit item: {password} -u -id {ID of item} [Optional -title {Name of app}] [Optional -secret {2FA Base32 secret}] [Optional -digits {Number of digits}]
* Remove an totp item:  {password} -del -id {ID of app - ID is shown in the list}
* Display unencrypted totp data i.e. 2FA secrets etc: {password} -d
* Update password: {password} -pu {new password}
* See help: -h

## Source
Source code can be obtained with

    git clone --recursive https://github.com/bifter/totp-manager-python
# TOTP Explantion and need of implementation* 
Explain-
{If your website features a username+password authentication system, you owe it 
to your users to offer 2-factor authentication (or 2fa for short) as an additional
measure of protection for their accounts. If you're unfamiliar with 2fa, it's that
step in the login sequence that asks the user for a (typically) 6-digit numeric code
in order to complete user authentication. The 6 digit codes are either sent to the user's
phone as a text message upon a login attempt or generated by an app such as Google Authenticator.
Codes have a short validity period of typically 30 or 60 seconds. This will show you how
to implement such a system using java in a way that is compatible with Google Authenticator.}


Implementation-
{Your first idea for implementing the server side component of a 2fa system might be to randomly
generate 6 digit codes with short validity periods and send them to the user's phone in response 
to a login attempt. One major shortcoming with this approach is that your implementation wouldn't
be compatible with 2fa apps such as Google Authenticator which many users will prefer to use. 
In order to build a 2fa system that is compatible with Google Authenticator, we need to know what
algorithm it uses to generate codes. Fortunately, there is an RCF which precisely specifies the algorithm. 
RFC 6238 describes the "time-based one-time password" algorithm, or TOTP for short. The TOTP algorithm combines
a one time password (or secret key) and the current time to generate codes that change as time marches forward.
RFC 6238 also includes a reference implementation in java under the commercial-friendly Simplified BSD license.
This tutorial will show you how to use code from the RFC to build a working 2fa system that could easily be adapted 
into your java project.}    
    
